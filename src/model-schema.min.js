define("./Model",function(){return function(e){var d=[],f,i,g=0,h={};this.objects={all:function(){return d.slice()},create:function(a){return new f(a)},add:function(a){"__id__"in a||("defineProperty"in Object?Object.defineProperty(a,"__id__",{value:g,enumerable:!1}):a.__id__=g);d.push(a);return h[a.__id__]=a},filter:function(a){return"function"==typeOf(a)?d.filter(a):d.filter(function(c){for(var b in a)if(c[b]!==a[b])return!1;return!0})},exclude:function(a){return"function"==typeOf(a)?d.filter(function(c){return!a(c)}):
d.filter(function(c){for(var b in a)if(c[b]===a[b])return!1;return!0})},count:function(){return d.length},sort:function(a){return"function"==typeOf(a)?d.slice().sort(a):d.slice().sort(function(c,b){return"number"==typeof c[a]?c[a]-b[a]:c[a]>b[a]?1:c[a]<b[a]?-1:0})},get:function(a,c){var b,e;if("undefined"==typeof c&&"number"==typeof a)return h[a];if("object"==typeof a)for(e in a)for(b=0;b<d.length;b++)if(d[b][e]===a[e])return d[b];if("undefined"!=typeof c)for(b=0;b<d.length;b++)if(d[b][a]===c)return d[b];
return null},getOrCreate:function(a,c){var b;if(b=this.get(a))return b;Object.merge(a,c);return this.create(a)},"delete":function(a){var c,b;if("number"==typeof a)return(c=h[a])?(d.indexOf(c),d.splice(b,1),delete h[a.__id__],this.fireEvent("delete",c),!0):!1;b=d.indexOf(a);return~b?(d.splice(b,1),delete h[a.__id__],this.fireEvent("delete",a),!0):!1},observersType:{},fireEvent:function(a){this.observersType[a]=this.observersType[a]||[];var c=0,b=this.observersType[a],d=[].slice.call(arguments);for(d.splice(0,
1,this);c<b.length;c++)b[c].apply(this,d)},addEvent:function(a,c){this.observersType[a]=this.observersType[a]||[];~this.observersType[a].indexOf(c)||this.observersType[a].push(c)},removeEvent:function(a,c){var b;this.observersType[a]=this.observersType[a]||[];~(b=this.observersType[a].indexOf(c))&&this.observersType[a].splice(b,1)}};i=e.initialize||function(a){for(var c in a)"undefined"!=typeof this[c]&&(this[c]=a[c])};e.initialize=function(){"defineProperty"in Object?Object.defineProperty(this,"__id__",
{value:g,enumerable:!1}):this.__id__=g;g++;this.__objects__.add(this);this.initialize=i;this.initialize.apply(this,[].slice.call(arguments));this.__objects__.fireEvent("create",this)};e.Implements?"array"==typeOf(e.Implements)&&~e.Implements.indexOf(Events)?e.Implements.push(Events):"array"!=typeOf(e.Implements)&&(e.Implements=[e.Implements,Events]):e.Implements=Events;f=new Class(e);"defineProperty"in Object?(Object.defineProperty(f.prototype,"__objects__",{value:this.objects,enumerable:!1}),Object.defineProperty(f,
"objects",{value:this.objects,enumerable:!1})):(f.prototype.__objects__=this.objects,f.objects=this.objects);return f}});